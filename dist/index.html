<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Falling Objects Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            background: #1a1a2e;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: white;
        }
        .container {
            text-align: center;
        }
        h1 {
            margin-bottom: 20px;
            color: #44ff44;
            font-size: 36px;
        }
        canvas {
            border: 3px solid #44ff44;
            background: #0a0e27;
            display: block;
            margin: 0 auto;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(68, 255, 68, 0.5);
        }
        .controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background: #44ff44;
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }
        button:hover {
            background: #66ff66;
            transform: scale(1.05);
        }
        .instructions {
            margin-top: 20px;
            font-size: 14px;
            color: #aaa;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ FALLING OBJECTS GAME</h1>
        <canvas id="gameCanvas" width="800" height="500"></canvas>
        <div class="controls">
            <button onclick="gameStart()">‚ñ∂Ô∏è START</button>
            <button onclick="gameStop()">‚èπÔ∏è STOP</button>
        </div>
        <div class="instructions">
            <p>‚¨ÖÔ∏è Use Arrow Keys or Mouse to move</p>
            <p>Catch the falling objects! Score increases with each level!</p>
        </div>
    </div>

    <script>
        console.log("üéÆ Game script loading...");

        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        let gameRunning = false;
        let score = 0;
        let level = 1;
        let lastTime = Date.now();
        let spawnCounter = 0;

        // Player
        const player = {
            x: canvas.width / 2,
            y: canvas.height - 40,
            width: 80,
            height: 20,
            vx: 0,
            color: "#00ff00"
        };

        // Objects array
        let objects = [];

        // Setup controls
        window.addEventListener("keydown", (e) => {
            if (e.key === "ArrowLeft" || e.key === "a") player.vx = -300;
            if (e.key === "ArrowRight" || e.key === "d") player.vx = 300;
        });

        window.addEventListener("keyup", (e) => {
            if (e.key === "ArrowLeft" || e.key === "a" || e.key === "ArrowRight" || e.key === "d") {
                player.vx = 0;
            }
        });

        canvas.addEventListener("mousemove", (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) * (canvas.width / rect.width);
            player.x = Math.max(40, Math.min(canvas.width - 40, x));
        });

        canvas.addEventListener("click", () => {
            if (!gameRunning) gameStart();
        });

        // Spawn object
        function spawnObject() {
            const colors = ["#ff9f80", "#ffdf6e", "#85e3ff", "#baffc9"];
            const color = colors[Math.floor(Math.random() * colors.length)];
            const speed = 100 + level * 50 + Math.random() * 100;

            objects.push({
                x: Math.random() * (canvas.width - 30) + 15,
                y: -30,
                width: 30,
                height: 30,
                vy: speed,
                color: color
            });
        }

        // Collision check
        function collides(obj) {
            return (
                obj.x < player.x + player.width / 2 &&
                obj.x + obj.width > player.x - player.width / 2 &&
                obj.y < player.y + player.height / 2 &&
                obj.y + obj.height > player.y - player.height / 2
            );
        }

        // Render
        function render() {
            // Background
            const grad = ctx.createLinearGradient(0, 0, 0, canvas.height);
            grad.addColorStop(0, "#020617");
            grad.addColorStop(1, "#020b3d");
            ctx.fillStyle = grad;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw objects
            for (let obj of objects) {
                ctx.fillStyle = obj.color;
                ctx.fillRect(obj.x - obj.width / 2, obj.y - obj.height / 2, obj.width, obj.height);
                ctx.strokeStyle = "#ffffff";
                ctx.lineWidth = 2;
                ctx.strokeRect(obj.x - obj.width / 2, obj.y - obj.height / 2, obj.width, obj.height);
            }

            // Draw player
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x - player.width / 2, player.y - player.height / 2, player.width, player.height);
            ctx.strokeStyle = "#ffffff";
            ctx.lineWidth = 2;
            ctx.strokeRect(player.x - player.width / 2, player.y - player.height / 2, player.width, player.height);

            // Draw HUD
            ctx.fillStyle = "#ffffff";
            ctx.font = "20px Arial";
            ctx.fillText("Score: " + score, 20, 30);
            ctx.fillText("Level: " + level, 20, 60);
            ctx.fillText("Objects: " + objects.length, 20, 90);

            // Draw start message if not running
            if (!gameRunning) {
                ctx.fillStyle = "rgba(0,0,0,0.7)";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = "#44ff44";
                ctx.font = "40px Arial";
                ctx.textAlign = "center";
                ctx.fillText("üöÄ CLICK TO START", canvas.width / 2, canvas.height / 2 - 40);
                ctx.font = "20px Arial";
                ctx.fillText("Use Arrow Keys or Mouse", canvas.width / 2, canvas.height / 2 + 30);
                ctx.textAlign = "left";
            }
        }

        // Game loop
        function gameLoop() {
            if (!gameRunning) {
                render();
                requestAnimationFrame(gameLoop);
                return;
            }

            const now = Date.now();
            const dt = (now - lastTime) / 1000;
            lastTime = now;

            // Update player
            player.x += player.vx * dt;
            player.x = Math.max(40, Math.min(canvas.width - 40, player.x));

            // Spawn objects
            spawnCounter += dt;
            if (spawnCounter > 0.5 / level) {
                spawnObject();
                spawnCounter = 0;
            }

            // Update objects
            for (let i = objects.length - 1; i >= 0; i--) {
                objects[i].y += objects[i].vy * dt;

                // Check collision
                if (collides(objects[i])) {
                    score += 10 * level;
                    objects.splice(i, 1);
                    if (score % 100 === 0) level++;
                    playSound(800, 0.1);
                } else if (objects[i].y > canvas.height) {
                    objects.splice(i, 1);
                }
            }

            render();
            requestAnimationFrame(gameLoop);
        }

        // Sound
        function playSound(freq, duration) {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                osc.connect(gain);
                gain.connect(audioContext.destination);
                osc.frequency.value = freq;
                gain.gain.setValueAtTime(0.1, audioContext.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                osc.start(audioContext.currentTime);
                osc.stop(audioContext.currentTime + duration);
            } catch (e) {
                console.log("Audio not available");
            }
        }

        // Global functions
        window.gameStart = function() {
            console.log("üéÆ Starting game...");
            gameRunning = true;
            lastTime = Date.now();
        };

        window.gameStop = function() {
            console.log("‚èπÔ∏è Stopping game...");
            gameRunning = false;
            score = 0;
            level = 1;
            objects = [];
            spawnCounter = 0;
        };

        // Start game loop
        console.log("‚úÖ Game ready! Starting loop...");
        gameLoop();

        // Auto-start after 2 seconds
        setTimeout(() => {
            console.log("‚è±Ô∏è Auto-starting game...");
            gameStart();
        }, 2000);
    </script>
</body>
</html>
