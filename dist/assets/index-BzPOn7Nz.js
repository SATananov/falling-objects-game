var F=Object.defineProperty;var M=(r,t,e)=>t in r?F(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var o=(r,t,e)=>M(r,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function e(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=e(n);fetch(n.href,i)}})();function O(r,t){return r.x<t.x+t.width&&r.x+r.width>t.x&&r.y<t.y+t.height&&r.y+r.height>t.y}function d(r,t){return Math.random()*(t-r)+r}function L(r){return r[Math.floor(Math.random()*r.length)]}class A{constructor(){o(this,"audioContext",null)}ensureAudioContext(){this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),this.audioContext.state==="suspended"&&this.audioContext.resume()}initAudio(){this.ensureAudioContext()}playSound(t,e,s=.3,n="sine"){if(this.ensureAudioContext(),!this.audioContext)return;const i=this.audioContext.currentTime,l=this.audioContext.createOscillator(),a=this.audioContext.createGain();l.connect(a),a.connect(this.audioContext.destination),l.type=n,l.frequency.setValueAtTime(t,i),a.gain.setValueAtTime(s,i),a.gain.exponentialRampToValueAtTime(.01,i+e),l.start(i),l.stop(i+e)}playCollisionSound(){this.playSound(200,.1,.4,"square"),setTimeout(()=>this.playSound(150,.1,.3,"square"),50)}playLevelPassSound(){this.playSound(523,.1,.3,"sine"),setTimeout(()=>this.playSound(659,.1,.3,"sine"),120),setTimeout(()=>this.playSound(784,.1,.3,"sine"),240),setTimeout(()=>this.playSound(1047,.2,.3,"sine"),360)}playFireworksSound(){this.playSound(800,.05,.25,"square")}}class z{constructor(){o(this,"particles",[])}createExplosion(t,e,s=50){const n=["#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff","#ffffff"];for(let i=0;i<s;i++){const l=Math.PI*2*i/s,a=d(150,350),c=Math.cos(l)*a,h=Math.sin(l)*a;this.particles.push({x:t,y:e,vx:c,vy:h,life:1,maxLife:d(.8,1.5),color:L(n)})}}update(t){this.particles.forEach(e=>{e.x+=e.vx*t,e.y+=e.vy*t,e.vy+=300*t,e.life-=t}),this.particles=this.particles.filter(e=>e.life>0)}render(t){this.particles.forEach(e=>{const s=Math.max(0,e.life/e.maxLife);t.save(),t.globalAlpha=s,t.fillStyle=e.color,t.beginPath(),t.arc(e.x,e.y,3,0,Math.PI*2),t.fill(),t.restore()})}hasParticles(){return this.particles.length>0}}class p{constructor(t,e,s,n){o(this,"location");o(this,"speed");o(this,"isAlive",!0);o(this,"color");o(this,"borderColor");this.location=t,this.speed={x:0,y:e},this.color=s,this.borderColor=n}move(t,e){this.location.y+=this.speed.y*t,this.location.y-100>e.height&&(this.isAlive=!1)}hasCollision(t){return O(this.getBounds(),t.getBounds())}}class B extends p{constructor(e,s,n,i,l){super(e,s,i,l);o(this,"radius");this.radius=n}getBounds(){return{x:this.location.x-this.radius,y:this.location.y-this.radius,width:this.radius*2,height:this.radius*2}}render(e){e.save(),e.beginPath(),e.arc(this.location.x,this.location.y,this.radius,0,Math.PI*2),e.fillStyle=this.color,e.fill(),e.lineWidth=2,e.strokeStyle=this.borderColor,e.stroke(),e.restore()}}class N extends p{constructor(e,s,n,i,l,a){super(e,s,i,l);o(this,"size");o(this,"angle",0);o(this,"angularSpeed");this.size=n,this.angularSpeed=a}move(e,s){super.move(e,s),this.angle+=this.angularSpeed*e}getBounds(){return{x:this.location.x-this.size/2,y:this.location.y-this.size/2,width:this.size,height:this.size}}render(e){e.save(),e.translate(this.location.x,this.location.y),e.rotate(this.angle),e.fillStyle=this.color,e.strokeStyle=this.borderColor,e.lineWidth=2,e.beginPath();const s=this.size/2;e.rect(-s,-s,this.size,this.size),e.fill(),e.stroke(),e.restore()}}class R extends p{constructor(e,s,n,i,l,a){super(e,s,i,l);o(this,"size");o(this,"angle",0);o(this,"angularSpeed");this.size=n,this.angularSpeed=a}move(e,s){super.move(e,s),this.angle+=this.angularSpeed*e}getBounds(){return{x:this.location.x-this.size/2,y:this.location.y-this.size/2,width:this.size,height:this.size}}render(e){const s=this.size/2;e.save(),e.translate(this.location.x,this.location.y),e.rotate(this.angle),e.beginPath(),e.moveTo(0,-s),e.lineTo(s,s),e.lineTo(-s,s),e.closePath(),e.fillStyle=this.color,e.fill(),e.lineWidth=2,e.strokeStyle=this.borderColor,e.stroke(),e.restore()}}class k extends p{constructor(e,s,n,i){super(e,s,"#ffffff","#000000");o(this,"text");o(this,"fontSize");this.text=i,this.fontSize=n}getBounds(){const e=this.fontSize;return{x:this.location.x-e/2,y:this.location.y-e/2,width:e,height:e}}render(e){e.save(),e.font=`${this.fontSize}px system-ui`,e.textAlign="center",e.textBaseline="middle",e.fillText(this.text,this.location.x,this.location.y),e.restore()}}class D extends p{constructor(e,s,n=15){super(e,s,"#ffff00","#ffcc00");o(this,"size");o(this,"rotation",0);this.size=n}getBounds(){return{x:this.location.x-this.size,y:this.location.y-this.size,width:this.size*2,height:this.size*2}}move(e,s){this.rotation+=.1,super.move(e,s)}render(e){e.save(),e.translate(this.location.x,this.location.y),e.rotate(this.rotation),e.fillStyle=this.color,e.strokeStyle=this.borderColor,e.lineWidth=2;const s=5,n=this.size,i=this.size/2;e.beginPath();for(let l=0;l<s*2;l++){const a=l%2===0?n:i,c=l*Math.PI/s-Math.PI/2,h=Math.cos(c)*a,u=Math.sin(c)*a;l===0?e.moveTo(h,u):e.lineTo(h,u)}e.closePath(),e.fill(),e.stroke(),e.restore()}}class G extends p{constructor(e,s,n=15){super(e,s,"#00ccff","#0099cc");o(this,"size");this.size=n}getBounds(){return{x:this.location.x-this.size,y:this.location.y-this.size,width:this.size*2,height:this.size*2}}render(e){e.save(),e.translate(this.location.x,this.location.y),e.fillStyle=this.color,e.strokeStyle=this.borderColor,e.lineWidth=2,e.beginPath(),e.moveTo(0,-this.size),e.lineTo(this.size,0),e.lineTo(0,this.size),e.lineTo(-this.size,0),e.closePath(),e.fill(),e.stroke(),e.restore()}}class U{constructor(t,e,s,n,i){o(this,"location");o(this,"speed",{x:0,y:0});o(this,"width");o(this,"height");o(this,"color");o(this,"borderColor");o(this,"isAlive",!0);o(this,"moveSpeed",420);this.location=t,this.width=e,this.height=s,this.color=n,this.borderColor=i}moveLeft(t){this.location.x-=this.moveSpeed*t}moveRight(t){this.location.x+=this.moveSpeed*t}moveUp(t){this.location.y-=this.moveSpeed*t}moveDown(t){this.location.y+=this.moveSpeed*t}move(t,e){this.location.x<this.width/2&&(this.location.x=this.width/2),this.location.x>e.width-this.width/2&&(this.location.x=e.width-this.width/2),this.location.y<this.height/2&&(this.location.y=this.height/2),this.location.y>e.height-this.height/2&&(this.location.y=e.height-this.height/2)}getBounds(){return{x:this.location.x-this.width/2,y:this.location.y-this.height/2,width:this.width,height:this.height}}hasCollision(t){return O(this.getBounds(),t.getBounds())}render(t){const e=this.getBounds();t.save(),t.fillStyle=this.color,t.strokeStyle=this.borderColor,t.lineWidth=2,t.fillRect(e.x,e.y,e.width,e.height),t.strokeRect(e.x,e.y,e.width,e.height),t.restore()}}class ${constructor(t,e){this.startTime=t,this.factory=e}createGameObject(){return this.factory()}}class q{constructor(t,e,s,n,i){this.difficulty=t,this.duration=e,this.levelObjects=s,this.theme=n,this.kind=i}}class W{constructor(t,e){o(this,"width");o(this,"height");o(this,"gameObjects",[]);this.width=t,this.height=e}addObject(t){this.gameObjects.push(t)}removeDead(){this.gameObjects=this.gameObjects.filter(t=>t.isAlive)}}function H(r,t,e,s,n){const i=r/1e3,l=Math.floor(i*t*1.5),a=[],c=["üê∂","üê±","ü¶ä","üêª","üê∞","ü¶Å","üêº"],h=["üîß","üõ†","‚öô","üî©","ü™ö","üî®","ü™õ"];for(let u=0;u<l;u++){const f=d(0,r-500),m=d(40,e.width-40),y=d(-200,-40),E=80+t*30,T=190+t*60,g=d(E,T),b=d(28,48),S=b/2,j=()=>{if(s==="space")return new D({x:m,y},g,S);if(s==="ocean")return new G({x:m,y},g,S);if(n==="shapes"){const v=L(["circle","square","triangle"]),P=L(["#ff9f80","#ffdf6e","#85e3ff","#baffc9"]),I="#ffffff",x=d(-2.5,2.5);return v==="circle"?new B({x:m,y},g,S,P,I):v==="square"?new N({x:m,y},g,b,P,I,x):new R({x:m,y},g,b,P,I,x)}else if(n==="animals"){const v=L(c);return new k({x:m,y},g,b,v)}else{const v=L(h);return new k({x:m,y},g,b,v)}};a.push(new $(f,j))}return a.sort((u,f)=>u.startTime-f.startTime),new q(t,r,a,s,n)}class V{constructor(t){o(this,"canvas");o(this,"ctx");o(this,"field");o(this,"player");o(this,"levels",[]);o(this,"currentLevelIndex",0);o(this,"levelStartTime",0);o(this,"lastFrameTime",0);o(this,"nextLevelObjectIndex",0);o(this,"status","IDLE");o(this,"animationFrameId",0);o(this,"leftPressed",!1);o(this,"rightPressed",!1);o(this,"upPressed",!1);o(this,"downPressed",!1);o(this,"stars",[]);o(this,"fireworks",new z);o(this,"audioManager",new A);o(this,"backgroundMusic",document.getElementById("background-music"));o(this,"levelPassedTimer",0);o(this,"levelPassedTimeoutId",null);o(this,"isLevelPassed",!1);o(this,"levelPassedStartTime",0);o(this,"statusLabel",document.getElementById("status"));o(this,"objectsLabel",document.getElementById("objects"));o(this,"timeLabel",document.getElementById("time"));o(this,"progressFill",document.getElementById("progress-fill"));o(this,"gameOverOverlay",document.getElementById("game-over-overlay"));o(this,"playAgainBtn",document.getElementById("btn-play-again"));o(this,"levelPassedOverlay",document.getElementById("level-passed-overlay"));o(this,"levelPassedText",document.getElementById("level-passed-text"));o(this,"nextLevelBtn",document.getElementById("btn-next-level"));o(this,"welcomeOverlay",document.getElementById("welcome-overlay"));o(this,"loop",t=>{if(this.status!=="RUNNING"){cancelAnimationFrame(this.animationFrameId);return}const s=(t-this.lastFrameTime)/1e3;this.lastFrameTime=t;const n=this.levels[this.currentLevelIndex],i=t-this.levelStartTime;for(;this.nextLevelObjectIndex<n.levelObjects.length&&n.levelObjects[this.nextLevelObjectIndex].startTime<=i;){const a=n.levelObjects[this.nextLevelObjectIndex].createGameObject();this.field.addObject(a),this.nextLevelObjectIndex++}this.leftPressed&&this.player.moveLeft(s),this.rightPressed&&this.player.moveRight(s),this.upPressed&&this.player.moveUp(s),this.downPressed&&this.player.moveDown(s),this.player.move(s,this.field),this.field.gameObjects.forEach(l=>l.move(s,this.field)),this.field.removeDead();for(const l of this.field.gameObjects)if(l.hasCollision(this.player)){this.handlePlayerHit();break}i>=n.duration&&this.field.gameObjects.length===0&&this.handleLevelFinished(),this.fireworks.update(s),this.updateHud(i,n.duration),this.renderFrame(),this.animationFrameId=requestAnimationFrame(this.loop)});o(this,"levelPassedLoop",t=>{const e=t-this.levelPassedStartTime,s=200;if(Math.floor(e/s)%1===0&&e%s<16){const i=d(100,this.canvas.width-100),l=d(100,this.canvas.height-100);this.fireworks.createExplosion(i,l,30),this.audioManager.playFireworksSound()}this.fireworks.update(.016),this.renderFrame(),e<5e3?this.animationFrameId=requestAnimationFrame(this.levelPassedLoop):this.advanceToNextLevel()});const e=t.getContext("2d");if(!e)throw new Error("Canvas 2D context not available");this.canvas=t,this.ctx=e,this.field=new W(t.width,t.height);const s=110,n=18;this.player=new U({x:t.width/2,y:t.height-n-12},s,n,"#22e246","#ffffff");for(let i=0;i<80;i++)this.stars.push({x:Math.random()*t.width,y:Math.random()*t.height});this.initControls(),this.resetLevels(),this.updateHud(0,0),this.renderFrame()}resetLevels(){this.levels=[];const t=25e3,e=["night","day","factory","ocean","space"],s=["shapes","animals","tools"],n=[.7,.85,.9,.95,1];for(let i=0;i<100;i++){const l=i%5,a=Math.floor(i/5),h=n[l]+a*.15,u=e[l],f=s[l%3];this.levels.push(H(t,h,this.field,u,f))}this.currentLevelIndex=0}start(){if(this.status==="RUNNING")return;this.audioManager.initAudio(),this.resetLevels(),this.currentLevelIndex=0,this.isLevelPassed=!1,this.status="RUNNING";const t=performance.now();this.field.gameObjects=[],this.player.isAlive=!0,this.levelStartTime=t,this.lastFrameTime=t,this.nextLevelObjectIndex=0,this.gameOverOverlay.classList.add("hidden"),this.levelPassedOverlay.classList.add("hidden"),this.welcomeOverlay.classList.add("hidden"),this.backgroundMusic&&(this.backgroundMusic.currentTime=0,this.backgroundMusic.play().catch(()=>{})),this.statusLabel.textContent=`Status: RUNNING (Level ${this.currentLevelIndex+1}/${this.levels.length})`,this.loop(t)}pause(){this.status==="RUNNING"&&(this.status="PAUSED",this.statusLabel.textContent="Status: PAUSED",this.backgroundMusic&&this.backgroundMusic.pause())}resume(){this.status==="PAUSED"&&(this.status="RUNNING",this.statusLabel.textContent=`Status: RUNNING (Level ${this.currentLevelIndex+1}/${this.levels.length})`,this.lastFrameTime=performance.now(),this.backgroundMusic&&this.backgroundMusic.play(),this.loop(this.lastFrameTime))}stop(){this.status="STOPPED",this.isLevelPassed=!1,this.statusLabel.textContent="Status: STOPPED",this.gameOverOverlay.classList.add("hidden"),this.levelPassedOverlay.classList.add("hidden"),this.backgroundMusic&&(this.backgroundMusic.pause(),this.backgroundMusic.currentTime=0),cancelAnimationFrame(this.animationFrameId),this.field.gameObjects=[],this.updateHud(0,0),this.renderFrame()}handlePlayerHit(){this.status="STOPPED",this.statusLabel.textContent="Status: GAME OVER",this.gameOverOverlay.classList.remove("hidden"),this.audioManager.playCollisionSound()}handleLevelFinished(){this.status="STOPPED",this.isLevelPassed=!0,this.levelPassedStartTime=performance.now(),this.audioManager.playLevelPassSound();for(let t=0;t<5;t++){const e=d(100,this.canvas.width-100),s=d(100,this.canvas.height-100);this.fireworks.createExplosion(e,s,40),this.audioManager.playFireworksSound()}this.currentLevelIndex<this.levels.length-1?(this.levelPassedText.textContent=`You Pass Level ${this.currentLevelIndex+1}`,this.levelPassedOverlay.classList.remove("hidden"),this.animationFrameId=requestAnimationFrame(this.levelPassedLoop)):(this.status="FINISHED",this.statusLabel.textContent="Status: ALL LEVELS COMPLETE",this.levelPassedText.textContent=`You Pass Level ${this.currentLevelIndex+1} - ALL COMPLETE!`,this.levelPassedOverlay.classList.remove("hidden"))}advanceToNextLevel(){if(this.currentLevelIndex<this.levels.length-1){this.isLevelPassed=!1,this.currentLevelIndex++,this.levelPassedOverlay.classList.add("hidden");const t=performance.now();this.field.gameObjects=[],this.levelStartTime=t,this.lastFrameTime=t,this.nextLevelObjectIndex=0,this.status="RUNNING",this.statusLabel.textContent=`Status: RUNNING (Level ${this.currentLevelIndex+1}/${this.levels.length})`,this.animationFrameId=requestAnimationFrame(this.loop)}}renderFrame(){const t=this.ctx,e=this.canvas.width,s=this.canvas.height,n=this.levels[this.currentLevelIndex];if(t.save(),n.theme==="night"){const i=t.createLinearGradient(0,0,0,s);i.addColorStop(0,"#020617"),i.addColorStop(1,"#020b3d"),t.fillStyle=i,t.fillRect(0,0,e,s),t.fillStyle="#ffffff",this.stars.forEach(l=>{t.beginPath(),t.arc(l.x,l.y,1.5,0,Math.PI*2),t.fill()})}else if(n.theme==="day"){const i=t.createLinearGradient(0,0,0,s);i.addColorStop(0,"#9ad9ff"),i.addColorStop(1,"#e9f7ff"),t.fillStyle=i,t.fillRect(0,0,e,s),t.fillStyle="#6cc070",t.fillRect(0,s-40,e,40)}else if(n.theme==="factory"){const i=t.createLinearGradient(0,0,e,s);i.addColorStop(0,"#2b103e"),i.addColorStop(1,"#7e3ff2"),t.fillStyle=i,t.fillRect(0,0,e,s),t.fillStyle="rgba(255,255,255,0.1)";for(let l=0;l<6;l++){const a=l*e/6;t.fillRect(a,0,8,s)}}else if(n.theme==="ocean"){const i=t.createLinearGradient(0,0,0,s);i.addColorStop(0,"#1a5f7a"),i.addColorStop(.5,"#2a8fa5"),i.addColorStop(1,"#0d4a63"),t.fillStyle=i,t.fillRect(0,0,e,s),t.strokeStyle="rgba(255,255,255,0.15)",t.lineWidth=2;for(let l=0;l<5;l++)t.beginPath(),t.arc(e/2,s/2+l*40,60-l*10,0,Math.PI*2),t.stroke()}else if(n.theme==="space"){const i=t.createLinearGradient(0,0,e,s);i.addColorStop(0,"#000011"),i.addColorStop(.5,"#0a0033"),i.addColorStop(1,"#000022"),t.fillStyle=i,t.fillRect(0,0,e,s),t.fillStyle="rgba(255,255,255,0.8)";for(let l=0;l<15;l++){const a=Math.random()*e,c=Math.random()*s,h=Math.random()*1.5;t.beginPath(),t.arc(a,c,h,0,Math.PI*2),t.fill()}t.fillStyle="rgba(200,100,255,0.1)",t.fillRect(0,0,e/2,s/2)}t.restore(),this.player.render(t),this.field.gameObjects.forEach(i=>i.render(t)),this.fireworks.render(t)}updateHud(t,e){const s=t/1e3,n=e/1e3;this.objectsLabel.textContent=`Objects: ${this.field.gameObjects.length}`,this.timeLabel.textContent=`Time: ${s.toFixed(2)}s / ${n.toFixed(2)}s`;const i=e>0?Math.min(1,t/e):0;this.progressFill.style.width=`${i*100}%`}initControls(){const t=document.getElementById("btn-start"),e=document.getElementById("btn-pause"),s=document.getElementById("btn-resume"),n=document.getElementById("btn-stop"),i=document.getElementById("btn-start-welcome");t.addEventListener("click",()=>this.start()),i.addEventListener("click",()=>this.start()),e.addEventListener("click",()=>this.pause()),s.addEventListener("click",()=>this.resume()),n.addEventListener("click",()=>this.stop()),this.playAgainBtn.addEventListener("click",()=>this.start()),this.nextLevelBtn.addEventListener("click",()=>this.advanceToNextLevel()),window.addEventListener("keydown",a=>{a.key==="ArrowLeft"||a.key==="a"||a.key==="A"?this.leftPressed=!0:a.key==="ArrowRight"||a.key==="d"||a.key==="D"?this.rightPressed=!0:a.key==="ArrowUp"||a.key==="w"||a.key==="W"?this.upPressed=!0:(a.key==="ArrowDown"||a.key==="s"||a.key==="S")&&(this.downPressed=!0)}),window.addEventListener("keyup",a=>{a.key==="ArrowLeft"||a.key==="a"||a.key==="A"?this.leftPressed=!1:a.key==="ArrowRight"||a.key==="d"||a.key==="D"?this.rightPressed=!1:a.key==="ArrowUp"||a.key==="w"||a.key==="W"?this.upPressed=!1:(a.key==="ArrowDown"||a.key==="s"||a.key==="S")&&(this.downPressed=!1)});const l=(a,c)=>{const h=this.canvas.getBoundingClientRect(),u=a-h.left,f=c-h.top;this.player.location.x=u*(this.canvas.width/h.width),this.player.location.y=f*(this.canvas.height/h.height)};this.canvas.addEventListener("pointerdown",a=>{l(a.clientX,a.clientY)}),this.canvas.addEventListener("pointermove",a=>{(a.buttons!==0||a.pressure>0)&&l(a.clientX,a.clientY)})}}const C=document.getElementById("game-canvas"),w=new V(C);console.log("‚úÖ Game initialized successfully!");console.log("Canvas:",C);console.log("Game object:",w);window.game=w;setTimeout(()=>{w.status==="IDLE"&&(console.log("Auto-starting game after user interaction delay..."),w.start())},2e3);
